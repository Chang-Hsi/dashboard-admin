import{c as r,a as e,o,r as f,p as O,e as n,m as g,f as i,t as u,F as _,g as w,G as y,H as I,h as j,i as E,n as F,d as k,j as $,O as H,x as K,P as L,v as G}from"./index-CywFxlyx.js";import{s as m}from"./index-CIkfx8YZ.js";import{r as J}from"./ChatBubbleLeftRightIcon-B9j7SRN4.js";import{r as V}from"./EnvelopeIcon-J8_64iOo.js";import{r as P,a as U}from"./XMarkIcon-IDC03oyN.js";import{r as W}from"./Cog6ToothIcon-OC70DWHH.js";import{r as N}from"./GlobeAltIcon-DkiDq2iC.js";import{r as z}from"./UserGroupIcon-vOYRdn0k.js";import{r as Z}from"./PlusIcon-B3Z7r2G1.js";import"./index-rPo4Kne9.js";function A(h,p){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"})])}function q(h,p){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"})])}function Q(h,p){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 9v.906a2.25 2.25 0 0 1-1.183 1.981l-6.478 3.488M2.25 9v.906a2.25 2.25 0 0 0 1.183 1.981l6.478 3.488m8.839 2.51-4.66-2.51m0 0-1.023-.55a2.25 2.25 0 0 0-2.134 0l-1.022.55m0 0-4.661 2.51m16.5 1.615a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V8.844a2.25 2.25 0 0 1 1.183-1.981l7.5-4.039a2.25 2.25 0 0 1 2.134 0l7.5 4.039a2.25 2.25 0 0 1 1.183 1.98V19.5Z"})])}const X={class:"rounded-3xl bg-white p-5 shadow-sm"},Y={class:"mb-4 flex items-center justify-between"},ee={class:"flex items-center gap-2 text-sm text-slate-500"},te={class:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 font-medium text-slate-700"},se={class:"overflow-x-auto"},le={class:"min-w-full text-left text-base"},ae={class:"px-3 py-3 align-middle"},ne={class:"flex items-start gap-3"},ie={class:"mt-0.5 flex h-9 w-9 items-center justify-center rounded-full bg-slate-100"},oe={class:"text-base font-semibold text-slate-900"},re={class:"mt-0.5 text-sm text-slate-500"},de={class:"px-3 py-3 align-middle"},ce={class:"flex items-center gap-2"},ue={class:"px-3 py-3 align-middle"},me={class:"flex items-center gap-2 justify-center"},pe={class:"px-3 py-3 align-middle"},xe={class:"flex items-center gap-2"},ve={class:"px-3 py-3 align-middle"},fe={class:"px-3 py-3 align-middle"},he={class:"flex items-center justify-end gap-2"},be=["onClick"],ge={class:"flex w-full items-center justify-between"},_e={class:"flex items-center gap-3"},we={class:"flex h-9 w-9 items-center justify-center rounded-full bg-slate-100"},ye={key:0,class:"text-sm text-slate-500"},ke={key:0,class:"space-y-5"},Ve={class:"rounded-2xl bg-slate-50 px-4 py-3"},Ce={class:"mb-2 flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},je={class:"flex flex-col gap-3"},Ee={class:"flex items-center justify-between gap-4"},$e={class:"flex items-center gap-2"},Ue={class:"flex items-center justify-between gap-4"},Ne={class:"flex items-center gap-2"},Ae={class:"flex items-center justify-between gap-4"},Me={class:"flex items-center gap-2"},Se={class:"rounded-2xl bg-slate-50 px-4 py-3"},Te={class:"mb-2 flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},Be={class:"flex flex-wrap gap-3"},De=["value"],Re={class:"rounded-2xl bg-slate-50 px-4 py-3"},Oe={class:"mb-2 flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},Ie={class:"flex flex-col gap-2"},Fe={class:"flex items-center gap-2"},He=["onKeyup"],Ke=["disabled"],Le={key:0,class:"mt-1 flex flex-wrap gap-2"},Ge=["onClick"],Je={key:1,class:"mt-1 text-xs text-slate-400"},st={__name:"SettingsView",setup(h){const p=[{id:"admin",label:"管理員"},{id:"manager",label:"經理"},{id:"support",label:"客服"},{id:"sales",label:"業務"}],x=f([{id:1,key:"order.created",name:"新訂單建立",description:"當客戶送出新訂單時通知相關人員。",icon:A,category:"訂單",channels:{web:!0,push:!0,email:!0},recipients:{roles:["admin","sales"],emails:["boss@company.com"]}},{id:2,key:"order.paid",name:"訂單付款完成",description:"付款完成後提醒財務與客服處理後續流程。",icon:J,category:"訂單",channels:{web:!0,push:!0,email:!0},recipients:{roles:["admin","support"],emails:[]}},{id:3,key:"comment.new",name:"有新留言",description:"客戶在系統中留下新的留言或回覆時通知客服。",icon:V,category:"訊息",channels:{web:!0,push:!1,email:!1},recipients:{roles:["support"],emails:[]}},{id:4,key:"system.error",name:"系統錯誤",description:"當系統發生例外錯誤時立刻通知技術負責人。",icon:P,category:"系統",channels:{web:!1,push:!0,email:!0},recipients:{roles:["admin"],emails:["devops@company.com"]}}]),v=f(!1),l=f(null),c=f(""),M=O(()=>`${x.value.length} 個通知事件`),S=a=>{const t=p.find(s=>s.id===a);return t?t.label:a},T=a=>{if(!a||!a.recipients)return"";const t=a.recipients.roles.length?"角色："+a.recipients.roles.map(S).join("、"):"",s=a.recipients.emails.length?"Email："+a.recipients.emails.join("、"):"";return!t&&!s?"尚未設定":t&&s?t+"；"+s:t||s},B=a=>{const t=JSON.parse(JSON.stringify(a));l.value={...t,icon:a.icon},c.value="",v.value=!0},b=()=>{v.value=!1,l.value=null,c.value=""},D=()=>{if(!l.value)return;const a=x.value.findIndex(t=>t.id===l.value.id);a!==-1&&(x.value[a]={...x.value[a],channels:{...l.value.channels},recipients:{roles:[...l.value.recipients.roles],emails:[...l.value.recipients.emails]}}),b()},C=()=>{if(!l.value)return;const a=c.value.trim();a&&(l.value.recipients.emails.includes(a)||l.value.recipients.emails.push(a),c.value="")},R=a=>{l.value&&(l.value.recipients.emails=l.value.recipients.emails.filter(t=>t!==a))};return(a,t)=>(o(),r("section",X,[e("div",Y,[t[6]||(t[6]=e("div",null,[e("h2",{class:"text-base font-semibold text-slate-900"},"NOTIFICATION SETTINGS"),e("p",{class:"mt-1 text-sm text-slate-500"},"管理系統通知事件、通道與通知對象")],-1)),e("div",ee,[e("span",te,[n(i(A),{class:"mr-1 h-3.5 w-3.5"}),g(" "+u(M.value),1)])])]),e("div",se,[e("table",le,[t[8]||(t[8]=e("thead",null,[e("tr",{class:"border-b border-slate-100 text-sm font-semibold uppercase tracking-[0.16em] text-slate-400"},[e("th",{class:"px-3 py-2"},"Event"),e("th",{class:"px-3 py-2"},"Web"),e("th",{class:"px-3 py-2"},"App Push"),e("th",{class:"px-3 py-2"},"Email"),e("th",{class:"px-3 py-2"},"Recipients"),e("th",{class:"px-3 py-2"})])],-1)),e("tbody",null,[(o(!0),r(_,null,w(x.value,s=>(o(),r("tr",{key:s.id,class:"border-b border-slate-100 last:border-0 hover:bg-slate-50/40"},[e("td",ae,[e("div",ne,[e("div",ie,[(o(),j(E(s.icon),{class:"h-5 w-5 text-blue-500"}))]),e("div",null,[e("div",oe,u(s.name),1),e("div",re,u(s.description),1)])])]),e("td",de,[e("div",ce,[n(i(m),{modelValue:s.channels.web,"onUpdate:modelValue":d=>s.channels.web=d},null,8,["modelValue","onUpdate:modelValue"])])]),e("td",ue,[e("div",me,[n(i(m),{modelValue:s.channels.push,"onUpdate:modelValue":d=>s.channels.push=d},null,8,["modelValue","onUpdate:modelValue"])])]),e("td",pe,[e("div",xe,[n(i(m),{modelValue:s.channels.email,"onUpdate:modelValue":d=>s.channels.email=d},null,8,["modelValue","onUpdate:modelValue"])])]),e("td",ve,[e("span",{class:F(s.recipients.roles.length||s.recipients.emails.length?"text-sm text-slate-700":"text-sm italic text-slate-400")},u(T(s)),3)]),e("td",fe,[e("div",he,[e("button",{type:"button",class:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-sm font-semibold text-slate-700 hover:bg-slate-200",onClick:d=>B(s)},[n(i(W),{class:"mr-1 h-4 w-4"}),t[7]||(t[7]=g(" 設定 ",-1))],8,be)])])]))),128))])])]),n(i(I),{visible:v.value,"onUpdate:visible":t[5]||(t[5]=s=>v.value=s),modal:!0,draggable:!1,closable:!1,style:{width:"480px"},class:"rounded-3xl"},{header:y(()=>[e("div",ge,[e("div",_e,[e("div",we,[l.value?(o(),j(E(l.value.icon),{key:0,class:"h-5 w-5 text-blue-500"})):k("",!0)]),e("div",null,[t[9]||(t[9]=e("div",{class:"text-base font-semibold text-slate-900"},"通知對象設定",-1)),l.value?(o(),r("div",ye,u(l.value.name),1)):k("",!0)])]),e("button",{type:"button",class:"rounded-full p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-700",onClick:b},[n(i(U),{class:"h-4 w-4"})])])]),footer:y(()=>[e("div",{class:"flex w-full items-center justify-between"},[e("button",{type:"button",class:"inline-flex items-center rounded-full px-4 py-1.5 text-sm font-medium text-slate-500 hover:bg-slate-100",onClick:b}," 取消 "),e("button",{type:"button",class:"inline-flex items-center rounded-full bg-slate-900 px-5 py-1.5 text-sm font-semibold text-white hover:bg-slate-800",onClick:D}," 儲存設定 ")])]),default:y(()=>[l.value?(o(),r("div",ke,[e("div",Ve,[e("div",Ce,[n(i(N),{class:"h-4 w-4"}),t[10]||(t[10]=e("span",null,"通知通道",-1))]),e("div",je,[e("div",Ee,[e("div",$e,[n(i(N),{class:"h-4 w-4 text-slate-500"}),t[11]||(t[11]=e("div",null,[e("div",{class:"text-sm font-medium text-slate-800"},"Web 通知"),e("div",{class:"text-xs text-slate-500"}," 顯示在系統右上角通知鈴鐺或通知列表。 ")],-1))]),n(i(m),{modelValue:l.value.channels.web,"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.channels.web=s)},null,8,["modelValue"])]),e("div",Ue,[e("div",Ne,[n(i(q),{class:"h-4 w-4 text-slate-500"}),t[12]||(t[12]=e("div",null,[e("div",{class:"text-sm font-medium text-slate-800"},"App 推播"),e("div",{class:"text-xs text-slate-500"},"透過手機 App 的推播訊息提醒。")],-1))]),n(i(m),{modelValue:l.value.channels.push,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.channels.push=s)},null,8,["modelValue"])]),e("div",Ae,[e("div",Me,[n(i(V),{class:"h-4 w-4 text-slate-500"}),t[13]||(t[13]=e("div",null,[e("div",{class:"text-sm font-medium text-slate-800"},"Email 通知"),e("div",{class:"text-xs text-slate-500"},"寄送 Email 到指定的收件人。")],-1))]),n(i(m),{modelValue:l.value.channels.email,"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.channels.email=s)},null,8,["modelValue"])])])]),e("div",Se,[e("div",Te,[n(i(z),{class:"h-4 w-4"}),t[14]||(t[14]=e("span",null,"通知角色",-1))]),e("div",Be,[(o(),r(_,null,w(p,s=>e("label",{key:s.id,class:"flex items-center gap-2 rounded-full border border-slate-200 px-3 py-1.5 text-sm text-slate-700 hover:border-slate-400"},[$(e("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>l.value.recipients.roles=d),type:"checkbox",class:"h-3.5 w-3.5 rounded border-slate-300 text-blue-600 focus:ring-blue-500",value:s.id},null,8,De),[[H,l.value.recipients.roles]]),e("span",null,u(s.label),1)])),64))])]),e("div",Re,[e("div",Oe,[n(i(Q),{class:"h-4 w-4"}),t[15]||(t[15]=e("span",null,"額外 Email",-1))]),e("div",Ie,[e("div",Fe,[$(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>c.value=s),type:"email",placeholder:"輸入 Email 後按 Enter 或點新增",class:"h-9 flex-1 rounded-full border border-slate-200 px-3 text-sm text-slate-700 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",onKeyup:K(L(C,["prevent"]),["enter"])},null,40,He),[[G,c.value]]),e("button",{type:"button",class:"inline-flex items-center rounded-full bg-slate-900 px-3 py-1.5 text-sm font-semibold text-white hover:bg-slate-800 disabled:bg-slate-300",disabled:!c.value.trim(),onClick:C},[n(i(Z),{class:"mr-1 h-3.5 w-3.5"}),t[16]||(t[16]=g(" 新增 ",-1))],8,Ke)]),l.value.recipients.emails.length?(o(),r("div",Le,[(o(!0),r(_,null,w(l.value.recipients.emails,s=>(o(),r("span",{key:s,class:"inline-flex items-center gap-1 rounded-full bg-white px-3 py-1 text-sm text-slate-700 shadow-sm ring-1 ring-slate-200"},[n(i(V),{class:"h-3.5 w-3.5"}),e("span",null,u(s),1),e("button",{type:"button",class:"ml-1 text-slate-400 hover:text-slate-700",onClick:d=>R(s)},[n(i(U),{class:"h-3 w-3"})],8,Ge)]))),128))])):(o(),r("p",Je," 若未設定額外 Email，系統只會依照上方角色發送通知。 "))])])])):k("",!0)]),_:1},8,["visible"])]))}};export{st as default};
